---
layout: post
title: XML parsing with Groovy
date: '2020-10-09T19:03:00.002-07:00'
author: Nadika Bandara
tags: 
modified_time: '2020-10-09T19:03:28.939-07:00'
thumbnail: https://1.bp.blogspot.com/--OKBze3fbPs/X4EVqwDZIHI/AAAAAAAAANA/ZCdc9iFLV9wg0zcSAi1FAZQQ-xrMSq9ggCLcBGAsYHQ/s72-c/download.jpeg
blogger_id: tag:blogger.com,1999:blog-3655785284384505198.post-5906652765442800055
blogger_orig_url: https://blog.nadikabandara.com/2020/10/xml-parsing-with-groovy.html
permalink: /2020/10/xml-parsing-with-groovy.html
---

<div class="separator" style="clear: both; text-align: center;"><a href="https://1.bp.blogspot.com/--OKBze3fbPs/X4EVqwDZIHI/AAAAAAAAANA/ZCdc9iFLV9wg0zcSAi1FAZQQ-xrMSq9ggCLcBGAsYHQ/s1050/download.jpeg" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" data-original-height="426" data-original-width="1050" src="https://1.bp.blogspot.com/--OKBze3fbPs/X4EVqwDZIHI/AAAAAAAAANA/ZCdc9iFLV9wg0zcSAi1FAZQQ-xrMSq9ggCLcBGAsYHQ/s16000/download.jpeg" /></a></div><div class="separator" style="clear: both; text-align: center;"><br /></div><div><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;">One of my mentees from <a href="https://www.codementor.io/@nadikasbandara" target="_blank">Codementor</a> had this issue with updating an XML file while preserving its original structure, whitespaces, and comments using Groovy. There were a couple of issues we ran into when working on this. XmlParser and XmlSlurper, the popular XML parsers in Groovy are both deprecated, and using them didn't preserve the original structure of the XML file when the output was saved. Here is a solution with using DOMBuilder and DOMCategory instead.</p><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;">Here's the sample input XML file I am using,</p><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;"><span style="box-sizing: inherit; font-size: 1em; font-weight: 600;">in.xml:</span></p><pre style="background-color: #f8f8f8; border-radius: 4px; border: 1px solid rgba(222, 229, 231, 0.6); box-sizing: inherit; display: inline-block; font-family: monospace, monospace; font-size: 18px; letter-spacing: 0.1px; margin-bottom: 31.2px; margin-left: -21.5938px; margin-top: 0px; overflow-x: scroll; padding: 1em 1.2em; width: 763.188px;"><code class="hljs xml" style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; border-radius: 4px; box-sizing: inherit; color: inherit; display: block; font-family: monospace, monospace; font-size: 15px; line-height: 22px; overflow-x: auto; padding: 0px; word-break: normal;"><span class="hljs-meta" style="box-sizing: inherit; color: #999999; font-weight: bold;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">meals</span>&gt;</span><br />    <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">&lt;!--Comment 1--&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">category</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">time</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"10am"</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">type</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"breakfast"</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Eggs<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Coffee<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">category</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">category</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">time</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"1pm"</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">type</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"lunch"</span> &gt;</span><br />        <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">&lt;!--Comment 2--&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Rice<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Beans<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">category</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">category</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">time</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"8pm"</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">type</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"dinner"</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Bread<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Chicken<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">category</span>&gt;</span><br />    <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">&lt;!--Comment 3--&gt;</span><br /><span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">meals</span>&gt;</span><br /></code></pre><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;">Here's the groovy script to parse the file, update some attributes and save the updated XML to an output file while preserving the original structure, whitespaces, and comments without using deprecated XmlParser and XmlSlurper,</p><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;"><span style="box-sizing: inherit; font-size: 1em; font-weight: 600;">xml.groovy:</span></p><pre style="background-color: #f8f8f8; border-radius: 4px; border: 1px solid rgba(222, 229, 231, 0.6); box-sizing: inherit; display: inline-block; font-family: monospace, monospace; font-size: 18px; letter-spacing: 0.1px; margin-bottom: 31.2px; margin-left: -21.5938px; margin-top: 0px; overflow-x: scroll; padding: 1em 1.2em; width: 763.188px;"><code class="hljs scala" style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; border-radius: 4px; box-sizing: inherit; color: inherit; display: block; font-family: monospace, monospace; font-size: 15px; line-height: 22px; overflow-x: auto; padding: 0px; word-break: normal;"><span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Import both DOMBuilder and DOMCategory</span><br /><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">import</span> groovy.xml.<span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">DOMBuilder</span>;<br /><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">import</span> groovy.xml.dom.<span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">DOMCategory</span>;<br /><br /><span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Convert the input XML file content to a string</span><br /><span class="hljs-function" style="box-sizing: inherit;"><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">def</span> <span class="hljs-title" style="box-sizing: inherit; color: #990000; font-weight: bold;">input</span> </span>= <span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">new</span> <span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">File</span>(<span class="hljs-symbol" style="box-sizing: inherit; color: #990073;">'in</span>.xml').text<br /><br /><span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Parse the input string using DOMBuilder</span><br /><span class="hljs-function" style="box-sizing: inherit;"><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">def</span> <span class="hljs-title" style="box-sizing: inherit; color: #990000; font-weight: bold;">doc</span> </span>= <span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">DOMBuilder</span>.parse(<span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">new</span> <span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">StringReader</span>(input))<br /><br /><span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Access the root element, which is meals</span><br /><span class="hljs-function" style="box-sizing: inherit;"><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">def</span> <span class="hljs-title" style="box-sizing: inherit; color: #990000; font-weight: bold;">meals</span> </span>= doc.documentElement<br /><br /><span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Use DOMCategory to update values</span><br />use(<span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">DOMCategory</span>) {<br />    <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Get the breakfast category</span><br />    <span class="hljs-function" style="box-sizing: inherit;"><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">def</span> <span class="hljs-title" style="box-sizing: inherit; color: #990000; font-weight: bold;">breakfast</span> </span>= meals.category[<span class="hljs-number" style="box-sizing: inherit; color: teal;">0</span>]<br />    <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Update the breakfast category time</span><br />    breakfast['<span class="hljs-meta" style="box-sizing: inherit; color: #999999; font-weight: bold;">@time</span>'] = <span class="hljs-symbol" style="box-sizing: inherit; color: #990073;">'7a</span>m'<br />}<br /><br /><span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">// Save the output to a file</span><br /><span class="hljs-keyword" style="box-sizing: inherit; color: #333333; font-weight: bold;">new</span> <span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">File</span>(<span class="hljs-symbol" style="box-sizing: inherit; color: #990073;">'out</span>.xml').write(meals as <span class="hljs-type" style="box-sizing: inherit; color: #445588; font-weight: bold;">String</span>)<br /></code></pre><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;">And here's the output XML file with updates,</p><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;"><span style="box-sizing: inherit; font-size: 1em; font-weight: 600;">out.xml:</span></p><pre style="background-color: #f8f8f8; border-radius: 4px; border: 1px solid rgba(222, 229, 231, 0.6); box-sizing: inherit; display: inline-block; font-family: monospace, monospace; font-size: 18px; letter-spacing: 0.1px; margin-bottom: 31.2px; margin-left: -21.5938px; margin-top: 0px; overflow-x: scroll; padding: 1em 1.2em; width: 763.188px;"><code class="hljs xml" style="background-attachment: initial; background-clip: initial; background-image: initial; background-origin: initial; background-position: initial; background-repeat: initial; background-size: initial; border-radius: 4px; box-sizing: inherit; color: inherit; display: block; font-family: monospace, monospace; font-size: 15px; line-height: 22px; overflow-x: auto; padding: 0px; word-break: normal;"><span class="hljs-meta" style="box-sizing: inherit; color: #999999; font-weight: bold;">&lt;?xml version="1.0" encoding="UTF-8"?&gt;</span><span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">meals</span>&gt;</span><br />    <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">&lt;!--Comment 1--&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">category</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">time</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"7am"</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">type</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"breakfast"</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Eggs<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Coffee<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">category</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">category</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">time</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"1pm"</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">type</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"lunch"</span>&gt;</span><br />        <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">&lt;!--Comment 2--&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Rice<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Beans<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">category</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">category</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">time</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"8pm"</span> <span class="hljs-attr" style="box-sizing: inherit; color: teal;">type</span>=<span class="hljs-string" style="box-sizing: inherit; color: #dd1144;">"dinner"</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Bread<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />        <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span>Chicken<span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">item</span>&gt;</span><br />    <span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">category</span>&gt;</span><br />    <span class="hljs-comment" style="box-sizing: inherit; color: #999988; font-style: italic;">&lt;!--Comment 3--&gt;</span><br /><span class="hljs-tag" style="box-sizing: inherit; color: navy;">&lt;/<span class="hljs-name" style="box-sizing: inherit;">meals</span>&gt;</span><br /></code></pre><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;"><span style="color: black; letter-spacing: 0.1px;"></span><span style="color: black; letter-spacing: 0.1px;"></span><span style="color: black; letter-spacing: 0.1px;"></span></p><p style="box-sizing: inherit; color: #444444; font-family: &quot;Open Sans&quot;, sans-serif; font-size: 18px; letter-spacing: 0.1px; line-height: 32px; margin-block-start: 0px; margin: 0px 0px 26px;">References,<br style="box-sizing: inherit;" /><a href="https://groovy-lang.org/processing-xml.html" rel="nofollow noopener" style="box-sizing: inherit; color: #009fc6; cursor: pointer; outline: none; text-decoration-line: none;" target="_blank">https://groovy-lang.org/processing-xml.html</a><br style="box-sizing: inherit;" /><a href="https://community.smartbear.com/t5/API-Functional-Security-Testing/Sharing-is-caring-how-to-modify-xml-files-using-ReadyApi/m-p/168661" rel="nofollow noopener" style="box-sizing: inherit; color: #009fc6; cursor: pointer; outline: none; text-decoration-line: none;" target="_blank">https://community.smartbear.com/t5/API-Functional-Security-Testing/Sharing-is-caring-how-to-modify-xml-files-using-ReadyApi/m-p/168661</a></p></div>